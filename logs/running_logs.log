[2022-01-22 14:57:57,631: INFO: 01_base_model_creation]: 
********************
[2022-01-22 14:57:57,631: INFO: 01_base_model_creation]: >>>>> stage creating base model started <<<<<
[2022-01-22 14:57:57,632: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 14:57:57,632: ERROR: 01_base_model_creation]: module 'keras.api._v2.keras' has no attribute 'dataset'
Traceback (most recent call last):
  File "src/01_base_model_creation.py", line 64, in <module>
    main(config_path=parsed_args.config)
  File "src/01_base_model_creation.py", line 26, in main
    (x_train_full,y_train_full) ,(x_test,y_test) = tf.keras.dataset.mnist.load_data()
AttributeError: module 'keras.api._v2.keras' has no attribute 'dataset'
[2022-01-22 14:58:08,832: INFO: 01_base_model_creation]: 
********************
[2022-01-22 14:58:08,832: INFO: 01_base_model_creation]: >>>>> stage creating base model started <<<<<
[2022-01-22 14:58:08,833: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 14:58:10,323: ERROR: 01_base_model_creation]: module 'keras.api._v2.keras.layers' has no attribute 'LeakyRelu'
Traceback (most recent call last):
  File "src/01_base_model_creation.py", line 64, in <module>
    main(config_path=parsed_args.config)
  File "src/01_base_model_creation.py", line 41, in main
    tf.keras.layers.LeakyRelu(),
AttributeError: module 'keras.api._v2.keras.layers' has no attribute 'LeakyRelu'
[2022-01-22 14:59:08,772: INFO: 01_base_model_creation]: 
********************
[2022-01-22 14:59:08,772: INFO: 01_base_model_creation]: >>>>> stage creating base model started <<<<<
[2022-01-22 14:59:08,772: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 14:59:09,702: INFO: 01_base_model_creation]: >>>>> stage creating base model completed!<<<<<

[2022-01-22 15:11:15,108: INFO: 01_base_model_creation]: 
********************
[2022-01-22 15:11:15,108: INFO: 01_base_model_creation]: >>>>> stage creating base model started <<<<<
[2022-01-22 15:11:15,109: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 15:11:15,611: ERROR: 01_base_model_creation]: fit() got an unexpected keyword argument 'epoch'
Traceback (most recent call last):
  File "src/01_base_model_creation.py", line 76, in <module>
    main(config_path=parsed_args.config)
  File "src/01_base_model_creation.py", line 59, in main
    verbose=2)
  File "/media/omkar/omkar/ineuron/regular/github/transfer_learning_template/env/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/media/omkar/omkar/ineuron/regular/github/transfer_learning_template/env/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
    return fn(*args, **kwargs)
TypeError: fit() got an unexpected keyword argument 'epoch'
[2022-01-22 15:11:28,385: INFO: 01_base_model_creation]: 
********************
[2022-01-22 15:11:28,385: INFO: 01_base_model_creation]: >>>>> stage creating base model started <<<<<
[2022-01-22 15:11:28,386: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 15:12:00,298: INFO: common]: created directory at: artifacts/models
[2022-01-22 15:12:00,350: INFO: 01_base_model_creation]: base model save dir artifacts/models/base_model.h5
[2022-01-22 15:12:00,376: INFO: 01_base_model_creation]: >>>>> stage creating base model completed!<<<<<

[2022-01-22 15:50:36,820: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 15:50:36,820: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 15:50:36,821: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 15:50:37,256: ERROR: 02_transfer_leraning]: update_even_odd_labels() takes 1 positional argument but 3 were given
Traceback (most recent call last):
  File "src/02_transfer_leraning.py", line 102, in <module>
    main(config_path=parsed_args.config)
  File "src/02_transfer_leraning.py", line 39, in main
    y_train_bin,y_test_bin,y_valid_bin = update_even_odd_labels(y_train,y_test,y_valid)
TypeError: update_even_odd_labels() takes 1 positional argument but 3 were given
[2022-01-22 15:51:24,251: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 15:51:24,251: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 15:51:24,252: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 15:51:24,656: ERROR: 02_transfer_leraning]: module 'tensorflow' has no attribute 'models'
Traceback (most recent call last):
  File "src/02_transfer_leraning.py", line 102, in <module>
    main(config_path=parsed_args.config)
  File "src/02_transfer_leraning.py", line 52, in main
    base_model = tf.models.load_model(base_model_path)
AttributeError: module 'tensorflow' has no attribute 'models'
[2022-01-22 15:51:54,813: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 15:51:54,813: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 15:51:54,813: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 15:51:55,333: INFO: 02_transfer_leraning]: loaded base model summary: 
 Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 10)                1010      
                                                                 
=================================================================
Total params: 266,610
Trainable params: 266,610
Non-trainable params: 0
_________________________________________________________________

[2022-01-22 15:51:55,345: INFO: 02_transfer_leraning]: >>>>> stage transfer learning completed!<<<<<

[2022-01-22 15:53:43,168: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 15:53:43,168: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 15:53:43,169: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 15:53:43,699: INFO: 02_transfer_leraning]: loaded base model summary: 
 Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 10)                1010      
                                                                 
=================================================================
Total params: 266,610
Trainable params: 266,610
Non-trainable params: 0
_________________________________________________________________

[2022-01-22 15:53:43,710: INFO: 02_transfer_leraning]: >>>>> stage transfer learning completed!<<<<<

[2022-01-22 16:01:15,733: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 16:01:15,733: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 16:01:15,734: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 16:01:16,173: INFO: 02_transfer_leraning]: loaded base model summary: 
 Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 10)                1010      
                                                                 
=================================================================
Total params: 266,610
Trainable params: 266,610
Non-trainable params: 0
_________________________________________________________________

[2022-01-22 16:01:16,173: ERROR: 02_transfer_leraning]: 'Sequential' object has no attribute 'layer'
Traceback (most recent call last):
  File "src/02_transfer_leraning.py", line 133, in <module>
    main(config_path=parsed_args.config)
  File "src/02_transfer_leraning.py", line 58, in main
    base_layer = base_model.layer[:-1]
AttributeError: 'Sequential' object has no attribute 'layer'
[2022-01-22 16:01:32,980: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 16:01:32,980: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 16:01:32,980: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 16:01:33,406: INFO: 02_transfer_leraning]: loaded base model summary: 
 Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 10)                1010      
                                                                 
=================================================================
Total params: 266,610
Trainable params: 266,610
Non-trainable params: 0
_________________________________________________________________

[2022-01-22 16:01:33,429: INFO: 02_transfer_leraning]: transfer model summary: 
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 2)                 202       
                                                                 
=================================================================
Total params: 265,802
Trainable params: 202
Non-trainable params: 265,600
_________________________________________________________________
 
[2022-01-22 16:01:54,126: INFO: common]: created directory at: artifacts/models
[2022-01-22 16:01:54,172: INFO: 02_transfer_leraning]: base model save dir artifacts/models/base_model.h5
[2022-01-22 16:01:54,172: ERROR: 02_transfer_leraning]: 'Sequential' object has no attribute 'evalution'
Traceback (most recent call last):
  File "src/02_transfer_leraning.py", line 133, in <module>
    main(config_path=parsed_args.config)
  File "src/02_transfer_leraning.py", line 87, in main
    logging.info(f"evalution metrics {new_model.evalution(x_test,y_test_bin)}")
AttributeError: 'Sequential' object has no attribute 'evalution'
[2022-01-22 16:02:15,617: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 16:02:15,617: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 16:02:15,618: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 16:02:16,088: INFO: 02_transfer_leraning]: loaded base model summary: 
 Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 2)                 202       
                                                                 
=================================================================
Total params: 265,802
Trainable params: 202
Non-trainable params: 265,600
_________________________________________________________________

[2022-01-22 16:02:16,111: INFO: 02_transfer_leraning]: transfer model summary: 
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 2)                 202       
                                                                 
=================================================================
Total params: 265,802
Trainable params: 202
Non-trainable params: 265,600
_________________________________________________________________
 
[2022-01-22 16:02:34,804: INFO: common]: created directory at: artifacts/models
[2022-01-22 16:02:34,823: INFO: 02_transfer_leraning]: base model save dir artifacts/models/base_model.h5
[2022-01-22 16:02:35,395: INFO: 02_transfer_leraning]: evalution metrics [0.2794519066810608, 0.8876000046730042]
[2022-01-22 16:02:35,405: INFO: 02_transfer_leraning]: >>>>> stage transfer learning completed!<<<<<

[2022-01-22 16:03:52,686: INFO: 02_transfer_leraning]: 
********************
[2022-01-22 16:03:52,686: INFO: 02_transfer_leraning]: >>>>> stage transfer learning started <<<<<
[2022-01-22 16:03:52,686: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-01-22 16:03:53,124: INFO: 02_transfer_leraning]: loaded base model summary: 
 Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 2)                 202       
                                                                 
=================================================================
Total params: 265,802
Trainable params: 202
Non-trainable params: 265,600
_________________________________________________________________

[2022-01-22 16:03:53,147: INFO: 02_transfer_leraning]: transfer model summary: 
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 784)               0         
                                                                 
 h1_layers (Dense)           (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 h2_layers (Dense)           (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 2)                 202       
                                                                 
=================================================================
Total params: 265,802
Trainable params: 202
Non-trainable params: 265,600
_________________________________________________________________
 
[2022-01-22 16:04:10,775: INFO: common]: created directory at: artifacts/models
[2022-01-22 16:04:10,790: INFO: 02_transfer_leraning]: base model save dir artifacts/models/transfer_model.h5
[2022-01-22 16:04:11,159: INFO: 02_transfer_leraning]: evalution metrics [0.2794519066810608, 0.8876000046730042]
[2022-01-22 16:04:11,171: INFO: 02_transfer_leraning]: >>>>> stage transfer learning completed!<<<<<

